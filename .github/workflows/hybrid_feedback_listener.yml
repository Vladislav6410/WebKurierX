name: 游대 Hybrid Feedback Listener (v1)

on:
  schedule:
    - cron: "*/15 * * * *"  # 쮏쒫왐햨햟 햨햟햤햢혦햣 15 햪햦햫혞혝
  workflow_dispatch:        # 혞혢햫쮏 향햟혞혜햨

jobs:
  fetch-hybrid-feedback:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: 游닍 Checkout repository
        uses: actions/checkout@v4

      - name: 游냀 Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: 游댢 Install dependencies
        run: pip install requests pyyaml

      - name: 游대 Pull feedback data from Hybrid
        env:
          HYBRID_FEEDBACK_ENDPOINT: ${{ secrets.HYBRID_FEEDBACK_ENDPOINT }}
          HYBRID_TOKEN: ${{ secrets.HYBRID_API_TOKEN }}
        run: |
          echo "游니 Fetching Hybrid feedback..."
          python scripts/pull_hybrid_feedback.py

      - name: 游 Commit feedback summary
        run: |
          git config --global user.name "WebKurierX Bot"
          git config --global user.email "bot@webkurier.ai"
          git add docs/FEEDBACK_STATUS.md || echo "No feedback updates"
          git commit -m "游대 sync: update Hybrid feedback summary" || echo "No new feedback"
          git push