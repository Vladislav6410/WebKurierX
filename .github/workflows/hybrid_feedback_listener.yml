name: ğŸ” Hybrid Feedback Listener (v1)

on:
  schedule:
    - cron: "*/15 * * * *"  # â± ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 15 Ğ¼Ğ¸Ğ½ÑƒÑ‚
  workflow_dispatch:        # Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº

jobs:
  fetch-hybrid-feedback:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: ğŸ“¦ Checkout repository
        uses: actions/checkout@v4

      - name: ğŸ Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: ğŸ”§ Install dependencies
        run: |
          pip install requests pyyaml

      - name: ğŸ›° Pull feedback data from Hybrid
        env:
          HYBRID_FEEDBACK_ENDPOINT: ${{ secrets.HYBRID_FEEDBACK_ENDPOINT }}
          HYBRID_TOKEN: ${{ secrets.HYBRID_TOKEN }}
        run: |
          echo "ğŸ“¡ Fetching Hybrid feedback..."
          python scripts/pull_hybrid_feedback.py

      - name: ğŸ’¾ Commit feedback summary + logs
        run: |
          git config --global user.name "WebKurierX Bot"
          git config --global user.email "bot@webkurier.ai"
          git add docs/FEEDBACK_STATUS.md logs/ || echo "No feedback updates"
          git commit -m "ğŸ” sync: update Hybrid feedback summary + logs" || echo "No new feedback"
          git push
